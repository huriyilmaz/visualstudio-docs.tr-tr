---
title: 'CA1403: Otomatik yerleşim türleri COM görünebilir olmamalıdır'
description: COM görünebilir bir değer türü, LayoutKind.Auto olarak ayarlanmış System.Runtime.InteropServices.StructLayoutAttribute özniteliğiyle işaretlenir.
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- AutoLayoutTypesShouldNotBeComVisible
- CA1403
helpviewer_keywords:
- CA1403
- AutoLayoutTypesShouldNotBeComVisible
ms.assetid: a7007714-f9b4-4730-94e0-67d3dc68991f
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.technology: vs-ide-code-analysis
dev_langs:
- CSharp
- VB
ms.workload:
- multiple
ms.openlocfilehash: e75af4ea9f60a78b8d282735daa9378e769b62db
ms.sourcegitcommit: 68897da7d74c31ae1ebf5d47c7b5ddc9b108265b
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 08/13/2021
ms.locfileid: "122098287"
---
# <a name="ca1403-auto-layout-types-should-not-be-com-visible"></a>CA1403: Otomatik yerleşim türleri COM görünebilir olmamalıdır

|Öğe|Değer|
|-|-|
|RuleId|CA1403|
|Kategori|Microsoft.Interoperability|
|Yeni değişiklik|Yeni|

## <a name="cause"></a>Nedeni

Bir Bileşen Nesne Modeli (COM) görünür değer türü, özniteliği <xref:System.Runtime.InteropServices.StructLayoutAttribute?displayProperty=fullName> olarak ayarlanmış şekilde <xref:System.Runtime.InteropServices.LayoutKind.Auto?displayProperty=fullName> işaretlenir.

## <a name="rule-description"></a>Kural açıklaması

<xref:System.Runtime.InteropServices.LayoutKind> düzen türleri ortak dil çalışma zamanı tarafından yönetilir. Bu türlerin düzeni. NET sürümleri arasında değişebilir ve bu da belirli bir düzen beklenmeyecek COM istemcilerini bozar. Öznitelik <xref:System.Runtime.InteropServices.StructLayoutAttribute> belirtilmezse C#, Visual Basic ve C++ derleyicileri değer türleri için [LayoutKind.Auto](<xref:System.Runtime.InteropServices.LayoutKind.Auto>) değerini belirtir.

Aksi belirtilmedikçe, tüm genel, genel olmayan türler COM'da görünür ve genel olmayan ve genel olmayan tüm türler COM'da görünmez. Ancak, hatalı pozitifleri azaltmak için bu kural türün COM görünürlüğünün açıkça belirtiliyor olması gerekir. İçeren derleme, olarak <xref:System.Runtime.InteropServices.ComVisibleAttribute?displayProperty=fullName> ayarlanmış olarak `false` işaretlenir ve türü olarak ayarlanmış şekilde <xref:System.Runtime.InteropServices.ComVisibleAttribute> `true` işaretlenir.

## <a name="how-to-fix-violations"></a>İhlalleri düzeltme

Bu kuralın ihlalini düzeltmek için özniteliğin değerini <xref:System.Runtime.InteropServices.StructLayoutAttribute> [LayoutKind.Explicit](<xref:System.Runtime.InteropServices.LayoutKind.Explicit>) veya [LayoutKind.Sequential](<xref:System.Runtime.InteropServices.LayoutKind.Sequential>)olarak değiştirebilir veya türü COM'da görünmez hale ebilirsiniz.

## <a name="when-to-suppress-warnings"></a>Uyarıların ne zaman gizlenmeleri

Bu kuraldan uyarıyı bastırmayın.

## <a name="example"></a>Örnek

Aşağıdaki örnek, kuralı ihlal eden bir türü ve kuralı karşıleyen bir türü gösterir.

:::code language="csharp" source="../snippets/csharp/VS_Snippets_CodeAnalysis/FxCop.Interoperability.AutoLayout/cs/FxCop.Interoperability.AutoLayout.cs" id="Snippet1":::
:::code language="vb" source="../snippets/visualbasic/VS_Snippets_CodeAnalysis/FxCop.Interoperability.AutoLayout/vb/FxCop.Interoperability.AutoLayout.vb" id="Snippet1":::

## <a name="related-rules"></a>İlgili kurallar

[CA1408: AutoDual ClassInterFaceType kullanmayın](../code-quality/ca1408.md)

## <a name="see-also"></a>Ayrıca bkz.

- [Birlikte çalışma için .NET türlerini nitelendirin](/dotnet/framework/interop/qualifying-net-types-for-interoperation)
- [Yönetilmeyen kod ile birlikte çalışma](/dotnet/framework/interop/index)
