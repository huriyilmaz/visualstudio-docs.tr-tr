---
title: 'Nasıl yapılır: Program Kodunda Dosyadan Model Açma'
description: ModelBus'ın modele veya modelde yer alan öğelere başvurmak ve taşınmışsa modeli bulmak için standart mekanizma sağladığını öğrenin.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: how-to
author: mgoertz-msft
ms.author: mgoertz
manager: jmartens
ms.technology: vs-ide-modeling
ms.workload:
- multiple
ms.openlocfilehash: 8636166da9506e7bf3d5923167e2a449b8000462
ms.sourcegitcommit: 68897da7d74c31ae1ebf5d47c7b5ddc9b108265b
ms.translationtype: MT
ms.contentlocale: tr-TR
ms.lasthandoff: 08/13/2021
ms.locfileid: "122157442"
---
# <a name="how-to-open-a-model-from-file-in-program-code"></a>Nasıl yapılır: Program Kodunda Dosyadan Model Açma

DSL modellerini herhangi bir uygulamada açabilirsiniz.

Bir Visual Studio ModelBus'i bu amaçla kullanabilirsiniz. ModelBus, modele veya modelde öğelere başvurmak ve taşınmışsa modeli bulmak için standart mekanizma sağlar. Daha fazla bilgi için [bkz. Modelbus kullanarak Visual Studio Tümleştirme.](../modeling/integrating-models-by-using-visual-studio-modelbus.md)

## <a name="target-framework"></a>Hedef çerçeve

Uygulama **projenizin Target çerçevesini** 4 veya .NET Framework olarak ayarlayın.

1. DSL Visual Studio okumak istediğiniz uygulamanın projesini açın.

2. Bu **Çözüm Gezgini,** projeye sağ tıklayın ve ardından Özellikler'e **tıklayın.**

3. Proje özellikleri penceresinde, Uygulama sekmesinde Hedef **çerçeve** alanını **4** (veya **daha** .NET Framework) olarak ayarlayın.

> [!NOTE]
> Hedef **çerçeve, 4 .NET Framework profiline sahip değil.**

## <a name="references"></a>Başvurular

Uygulama projenize şu Visual Studio ekleyin:

- `Microsoft.VisualStudio.Modeling.Sdk.11.0`

  - Başvuru Ekle iletişim kutusundaki **.NET** sekmesinin **altında** bunu görmüyorsanız, Gözat sekmesine tıklayın **ve** 'a `%Program Files%\Microsoft Visual Studio 2010 SDK\VisualStudioIntegration\Common\Assemblies\` gidin.

- DSL projenizin bin klasörünün altında bulabilirsiniz DSL derlemeniz. Adı genellikle şu şekildedir: *YourCompany*. *Projeniz.* `.Dsl.dll`

## <a name="important-classes-in-the-dsl"></a>DSL'de önemli sınıflar

DSL'nizi okuyabilen kodu yazmadan önce DSL'niz tarafından oluşturulan bazı sınıfların adlarını biliyor olması gerekir. DSL çözümde Dsl **projesini açın** ve **GeneratedCode klasörüne** bakın. Alternatif olarak, Başvurular projenizin DSL derlemesini çift **tıklatın** ve Object Browser'da DSL ad **alanını açın.**

Tanımlaması gereken sınıflar bunlardır:

- *YourDslRootClass* - Bu, içinde kök sınıfın `DslDefinition.dsl` adıdır.

- *YourDslName* `SerializationHelper` - Bu sınıf `SerializationHelper.cs` DSL projenizin içinde tanımlanır.

- *YourDslName* `DomainModel` - Bu sınıf `DomainModel.cs` DSL projenizin içinde tanımlanır.

## <a name="read-from-a-file"></a>Dosyadan okuma

Aşağıdaki örnek, önemli sınıfların aşağıdaki gibi olduğu bir DSL'i okumak için tasarlanmıştır:

- FamilyTreeModel

- FamilyTreeSerializationHelper

- FamilyTreeDomainModel

Bu DSL'de diğer etki alanı sınıfı Kişi'dir.

```csharp
using System;
using Microsoft.VisualStudio.Modeling;
using Company.FamilyTree; // Your DSL namespace

namespace StandaloneReadDslConsole
{ class Program
  { static void Main(string[] args)
    {
      // The path of a DSL model file:
      string dslModel = @"C:\FamilyTrees\Tudor.ftree";
      // Set up the Store to read your type of model:
      Store store = new Store(
        typeof(Company.FamilyTree.FamilyTreeDomainModel));
      // The Model type generated by the DSL:
      FamilyTreeModel familyTree;
      // All Store changes must be in a Transaction:
      using (Transaction t =
        store.TransactionManager.BeginTransaction("Load model"))
      {
        familyTree =
           FamilyTreeSerializationHelper.Instance.
              LoadModel(store, dslModel, null, null, null);
        t.Commit(); // Don't forget this!
      }
      // Now we can read the model:
      foreach (Person p in familyTree.People)
      {
        Console.WriteLine(p.Name);
        foreach (Person child in p.Children)
        {
          Console.WriteLine("    " + child.Name);
        }
} } } }
```

## <a name="save-to-a-file"></a>Dosyaya kaydetme

Önceki koda aşağıdaki ekleme, modelde bir değişiklik yapar ve sonra bunu bir dosyaya kaydeder.

```csharp
using (Transaction t =
  store.TransactionManager.BeginTransaction("update model"))
{
  // Create a new model element:
  Person p = new Person(store);
  // Set its embedding relationship:
  p.FamilyTreeModel = familyTree;
  // - same as: familyTree.People.Add(p);
  // Set its properties:
  p.Name = "Edward VI";
  t.Commit(); // Don't forget this!
}
// Save the model:
try
{
  SerializationResult result = new SerializationResult();
  FamilyTreeSerializationHelper.Instance
    .SaveModel(result, familyTree, @"C:\FamilyTrees\Tudor-upd.ftree");
  // Report any error:
  if (result.Failed)
  {
    foreach (SerializationMessage message in result)
    {
      Console.WriteLine(message);
    }
  }
}
catch (System.IO.IOException ex)
{ ... }
```
